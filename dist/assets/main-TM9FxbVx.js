import{c as q,o as L,q as O,a as Y,w as E,T as H,b as $,d as F}from"./main-DWbyKPN_.js";import{t as h,n as w,g as b,e as A,m as C,a as y,b as N}from"./en-US-06TOLqL0.js";/* empty css                */function U(n,s){let e=n,o=s,t=null;const i=q(F,"chats");return{addChat:async c=>{const g=new Date,a={username:o,room:e,message:c,created_at:H.fromDate(g)};try{return await $(i,a)}catch(l){throw console.log("Error form addchat = ",l),l}},getChats:c=>{t&&t(),t=L(O(i,E("room","==",e),Y("created_at")),g=>{g.docChanges().forEach(a=>{a.type==="added"&&c(a.doc.data())})})},updateChatroom:c=>{e=c,t&&t()},updateUsername:c=>{o=c,localStorage.setItem("username",o)}}}function p(n,s){const e=+h(n)-+h(s);return e<0?-1:e>0?1:e}function z(n,s,e){const[o,t]=w(e?.in,n,s),i=o.getFullYear()-t.getFullYear(),u=o.getMonth()-t.getMonth();return i*12+u}function R(n){return s=>{const o=(n?Math[n]:Math.trunc)(s);return o===0?0:o}}function j(n,s){return+h(n)-+h(s)}function k(n,s){const e=h(n,s?.in);return e.setHours(23,59,59,999),e}function G(n,s){const e=h(n,s?.in),o=e.getMonth();return e.setFullYear(e.getFullYear(),o+1,0),e.setHours(23,59,59,999),e}function B(n,s){const e=h(n,s?.in);return+k(e,s)==+G(e,s)}function J(n,s,e){const[o,t,i]=w(e?.in,n,n,s),u=p(t,i),r=Math.abs(z(t,i));if(r<1)return 0;t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-u*r);let m=p(t,i)===-u;B(o)&&r===1&&p(o,i)===1&&(m=!1);const d=u*(r-+m);return d===0?0:d}function K(n,s,e){const o=j(n,s)/1e3;return R(e?.roundingMethod)(o)}function P(n,s,e){const o=N(),t=e?.locale??o.locale??A,i=2520,u=p(n,s);if(isNaN(u))throw new RangeError("Invalid time value");const r=Object.assign({},e,{addSuffix:e?.addSuffix,comparison:u}),[m,d]=w(e?.in,...u>0?[s,n]:[n,s]),c=K(d,m),g=(b(d)-b(m))/1e3,a=Math.round((c-g)/60);let l;if(a<2)return e?.includeSeconds?c<5?t.formatDistance("lessThanXSeconds",5,r):c<10?t.formatDistance("lessThanXSeconds",10,r):c<20?t.formatDistance("lessThanXSeconds",20,r):c<40?t.formatDistance("halfAMinute",0,r):c<60?t.formatDistance("lessThanXMinutes",1,r):t.formatDistance("xMinutes",1,r):a===0?t.formatDistance("lessThanXMinutes",1,r):t.formatDistance("xMinutes",a,r);if(a<45)return t.formatDistance("xMinutes",a,r);if(a<90)return t.formatDistance("aboutXHours",1,r);if(a<C){const f=Math.round(a/60);return t.formatDistance("aboutXHours",f,r)}else{if(a<i)return t.formatDistance("xDays",1,r);if(a<y){const f=Math.round(a/C);return t.formatDistance("xDays",f,r)}else if(a<y*2)return l=Math.round(a/y),t.formatDistance("aboutXMonths",l,r)}if(l=J(d,m),l<12){const f=Math.round(a/y);return t.formatDistance("xMonths",f,r)}else{const f=l%12,x=Math.trunc(l/12);return f<3?t.formatDistance("aboutXYears",x,r):f<9?t.formatDistance("overXYears",x,r):t.formatDistance("almostXYears",x+1,r)}}function Q(n){return{newli:e=>{const o=P(e.created_at.toDate(),new Date,{addSuffix:!0}),t=`
             <li class="shadow rounded-lg px-4 py-2">
                <div class="flex justify-between">
                    <h5 class="text-gray-600 font-medium text-sm">${e.username}</h5>
                    <i class="text-gray-300 text-xs">${o}</i>
                </div>
                <p class="text-gray-600 text-sm">${e.message}</p>
            </li> 
        `;n.innerHTML+=t}}}const V=document.querySelector(".chatrooms"),v=document.querySelector(".chat-ul"),S=document.querySelector(".chat-form"),D=document.querySelector(".user-form"),T=document.querySelector(".msg"),_=document.querySelector(".roomtitle"),I=localStorage.username?localStorage.username:"Guest";D.username.placeholder=`username is ${I}`;const M=U("general",I);_.textContent="General";const X=Q(v);S.addEventListener("submit",n=>{n.preventDefault();const s=S.message.value.trim();M.addChat(s).then(()=>S.reset()).catch(e=>console.log(e))});D.addEventListener("submit",n=>{n.preventDefault();const s=D.username.value.trim();M.updateUsername(s),D.reset(),T.innerText=`New name updated to ${s}`,D.username.placeholder=`username is ${s}`,setTimeout(()=>T.innerText="",3e3)});V.addEventListener("click",n=>{n.preventDefault();const s=n.target.closest("button");if(s){const e=s.getAttribute("id"),o=s.querySelector("h3").innerText;_.textContent=o,v.innerHTML="",M.updateChatroom(e),M.getChats(t=>{X.newli(t)})}});M.getChats(n=>{X.newli(n)});
